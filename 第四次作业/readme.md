#第四次作业！  

##概述  

本次作业做了实现物体在流体中受重力的情况下，给定初速度、重力加速度、流体的阻力系数、物体质量、时间长度、时间分段的步长等条件下，计算速度与位移随时间变化的曲线的程序。

##计算方法

>###输入数据  

> - 总时间t_total
> - 时间分段长度dt
> - 分段数n=t_total/dt
> - 初速度v0
> - 重力加速度g
> - 质量m
> - 阻力系数a

>###计算  

> - i从1循环到n，每次增加dt的时间
> - 合加速度为 ![](http://www.forkosh.com/mathtex.cgi?%20\\frac\{dv\}\{dt\}=g-\\frac\{av\}\{m\})
> - 每次的速度增加近似认为是匀加速![](http://www.forkosh.com/mathtex.cgi?%20dv=\(g-\\frac\{av\}\{m\}\)dt)
> - 每次的位移增加近似看成匀加速运动![](http://www.forkosh.com/mathtex.cgi?%20\\frac\{dv\}\{dt\}=g-\\frac\{av\}\{m\}) <img src="http://www.forkosh.com/mathtex.cgi? dd=\(v+\\frac\{dv\}\{2\}\)dt">
> - 把每一次的t、v、d分别储存在三个数组中

>###输出结果

> - 分条输出每一步运算出的t、v、d的值
> - 将v-t,d-t曲线绘制出来

##更多分析

###问题

如果时间分段太粗，采用的近似就不可取，会使结果完全错误  

>例如:

> - 输入总时间(不要太大，否则可能看到的结果就是两条直线)：
> - 10
> - 输入初速度(向上为负)：
> - -1
> - 输入重力加速度：
> - 10
> - 输入f=av中的阻力系数a:
> - 6
> - 输入物体质量：
> - 1
> - 输入时间步长(建议不要大于 0.00833333333333 否则运算结果可能出现较大偏差)
> - 1
> - 0                -1.0                 0
> - 1.0               15.0               7.0
> - 2.0              -65.0              -18.0
> - 3.0               335.0              117.0
> - 4.0             -1665.0             -548.0
> - 5.0              8335.0             2787.0
> - 6.0            -41665.0            -13878.0
> - 7.0             208335.0            69457.0
> - 8.0           -1041665.0           -347208.0
> - 9.0            5208335.0           1736127.0
> - 10.0          -26041665.0         -8680538.0

显然这个计算结果是很荒谬的，原因是时间步长太长，那怎样才能避免这样的情况呢？

###解决

**如果程序可以自动根据输入的各个数据来确定应该去多长的步长较为合适就好了**  
所以考虑怎样的步长才合适，结论是：    
一步运算后的结果相较于前一步的加速度变化量远小于加速度的大小  
即：![](http://www.forkosh.com/mathtex.cgi?%20\\frac\{dv\}\{dt\}=g-\\frac\{av\}\{m\})<img src="http://www.forkosh.com/mathtex.cgi? \\Large \\Delta\\frac\{dv\}\{dt\}=frac\{a\\Deltav\}\{m\}=\\frac\{a\(g- \\frac\{av\}\{m\}\)\\Deltat\}\{m\}\\ll\(g-\\frac\{av\}\{m\}\)">  
即： ![](http://www.forkosh.com/mathtex.cgi?%20\\frac\{dv\}\{dt\}=g-\\frac\{av\}\{m\})<img src="http://www.forkosh.com/mathtex.cgi? \\Large \\Deltat\\ll\\frac\{m\}\{a\}">  

因此程序将自动提示建议时间步长取小于m/(20a),否则运算结果可能出现较大偏差。  
（上面的例子里已经有这个提示的功能了）

##最后

这个程序做出的图还很难看，之后将继续改进。
